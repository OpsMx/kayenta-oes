#FROM alpine:3.16
#LABEL maintainer="sig-platform@spinnaker.io"
#RUN apk --no-cache add --update bash openjdk11-jre
#RUN addgroup -S -g 10111 spinnaker
#RUN adduser -S -G spinnaker -u 10111 spinnaker

FROM quay.io/opsmxpublic/ubi8-jdk-11:v1
LABEL maintainer="info@opsmx.io"

RUN  microdnf install --setopt=tsflags=nodocs  openssh-clients  && \
  groupadd -g 10111 spinnaker && \
  useradd -g spinnaker -u 10111 spinnaker && \
  mkdir -p /opt/kayenta/plugins && chown -R spinnaker:spinnaker /opt/kayenta/plugins

COPY kayenta-web/build/install/kayenta /opt/kayenta
USER spinnaker
CMD ["/opt/kayenta/bin/kayenta"]
